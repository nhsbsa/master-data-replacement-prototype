{% extends "base.html" %}
{% block navcontent %}
<li class="nhsuk-breadcrumb__item">
    <a href="../index" class="nhsuk-breadcrumb__link">Home</a>
</li>
<li class="nhsuk-breadcrumb__item">
    <a href="../main/Searchfor-page" class="nhsuk-breadcrumb__link">Search</a>
</li>
<li class="nhsuk-breadcrumb__item">
    <a href="../tree.html" class="nhsuk-breadcrumb__link">Tree</a>
</li>
<li class="nhsuk-breadcrumb__item">
    <a href="insert-type" class="nhsuk-breadcrumb__link">Insert OU/PD</a>
</li>
<li class="nhsuk-breadcrumb__item">
    <a href="insert-name" class="nhsuk-breadcrumb__link">Name</a>
</li>
<li class="nhsuk-breadcrumb__item">
    <a href="insert-code" class="nhsuk-breadcrumb__link">Code</a>
</li>
<li class="nhsuk-breadcrumb__item">
    <a href="insert-ocs-code" class="nhsuk-breadcrumb__link">OCS code</a>
</li>
<li class="nhsuk-breadcrumb__item">
    <a href="insert-relationship" class="nhsuk-breadcrumb__link">Relationships</a>
</li>
{% endblock %}
{% block content %}


<style>
    details[open] + form {
        display: none;
    }
</style>

<div class="nhsuk-width-container">

<!--    <div class="nhsuk-back-link">-->
<!--        <a href="insert-relationship-additional.html" class="nhsuk-back-link__link" id="back-link">-->
<!--            <svg class="nhsuk-icon nhsuk-icon__chevron-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" height="24" width="24">-->
<!--                <path d="M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z"></path>-->
<!--            </svg>-->
<!--            Go back-->
<!--        </a>-->
<!--    </div>-->

    <h1 class="nhsuk-heading-l">Address search</h1>

        <span class="nhsuk-hint">Enter part of the address or postcode</span>

        <form action="" id="search-form">
            <div class="nhsuk-form-group">
                <label for="search" class="nhsuk-label nhsuk-label--s nhsuk-u-margin-bottom-3"></label>
                <input type="text" class="nhsuk-input nhsuk-input--width-20" id="search">
            </div>


            <div class="nhsuk-form-group">
                <button class="nhsuk-button" id="btn-search">Search</button>
                <button class="nhsuk-button nhsuk-button--secondary" id="btn-reset">Reset filter</button>
            </div>
        </form>

    <div class="nhsuk-table__panel-with-heading-tab nhsuk-table-responsive  " id="table-results" hidden>
        <h2 class="nhsuk-table__heading-tab">Results</h2>
        <table class="nhsuk-table">
            <thead class="nhsuk-table__head">
            <tr class="nhsuk-table__row">
                <th role="columnheader" scope="col">Address</th>
                <th role="columnheader" scope="col">Selecct</th>
            </tr>
            </thead>
            <tbody class="nhsuk-table__body">
            <tr role="row" class="nhsuk-table__row">
                <td class="nhsuk-table__cell">114 WESTBOURNE ROAD, HANDSWORTH, BIRMINGHAM, , B21 9TU</td>
                <td class="nhsuk-table__cell"><a href="#" class="nhsuk-link--no-visited-state" data-contact="114 WESTBOURNE ROAD, HANDSWORTH, BIRMINGHAM, , B21 9TU" >Select</a></td>
            </tr>
            <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">OAKESWELL HEALTH CENTRE, BRUNSWICK PARK ROAD, WEDNESBURY, WEST MIDLANDS, WS10 6TY</td>
                <td class="nhsuk-table__cell"><a href="#" class="nhsuk-link--no-visited-state" data-contact="OAKESWELL HEALTH CENTRE, BRUNSWICK PARK ROAD, WEDNESBURY, WEST MIDLANDS, WS10 6TY">Select</a></td>
            </tr>
            <tr class="nhsuk-table__row">
                <td class="nhsuk-table__cell">727 WEST ROAD, , NEWCASTLE, , NE15 7SE</td>
                <td class="nhsuk-table__cell"><a href="#" class="nhsuk-link--no-visited-state" data-contact="727 WEST ROAD, , NEWCASTLE, , NE15 7SE">Select</a></td>
            </tr>
            </tbody>
        </table>
        <nav class="nhsuk-pagination" aria-label="Pagination" role="navigation" >
            <ul class="nhsuk-list nhsuk-pagination__list">
                <li class="" style="display: inline-block; margin-right: 10px">
                    <a href="" class="nhsuk-pagination__link " >
                        <span class="" aria-hidden="true" role="presentation" style="">«</span>
                        <span class="" >Previous</span>
                    </a>
                </li>

                <li class="" style="display: inline-block;">
                    <a href="" class="nhsuk-pagination__link " style="">
                        <span class="" style="">1</span>
                    </a>
                </li>
                <li class="" style="display: inline-block">
                    <a href="" class="nhsuk-pagination__link " style="">
                        <span class="" style="">2</span>
                    </a>
                </li>
                <li class="" style="display: inline-block">
                    <a href="" class="nhsuk-pagination__link " style="">
                        <span class="" style="">3</span>
                    </a>
                </li>

                <li class="" style="display: inline-block">
                    <a href="" class="nhsuk-pagination__link " style="margin-left: 10px">
                        <span class="" style="">Next</span>
                        <span class="" aria-hidden="true" role="presentation" style="margin: 0">»</span>
                    </a>
                </li>
                <span style="display: inline; float: right">Showing 1 - 3 of 10 results</span>
            </ul>
        </nav>
    </div>

</div>

<script>
    const queryParams = window.location.search;
    const urlParams = new URLSearchParams(queryParams);
    const change = urlParams.get('change');
    const backLink = document.querySelector('#back-link');

    if(change == 'true'){
        backLink.href="summary.html"
    }

</script>

<script>
    const date = new Date();
    const day = "01";
    const month = date.getMonth()+1;
    const year = date.getFullYear();


    const startDay = document.querySelector('#start-day');
    const startMonth = document.querySelector('#start-month');
    const startYear = document.querySelector('#start-year');

    startDay.value = day;
    startMonth.value = month < 10 ? "0"+month.toString() : month.toString();
    startYear.value = year.toString();
</script>


<!--<script>-->

<!--    const button = document.querySelector('#continue');-->

<!--    button.addEventListener("click", (event) => {-->
<!--        event.preventDefault();-->
<!--        const queryParams = window.location.search;-->
<!--        const urlParams = new URLSearchParams(queryParams);-->
<!--        const change = urlParams.get('change');-->

<!--        const radioSelectedValue = document.querySelector('input[name="further-attributes"]:checked').value;-->

<!--        if(radioSelectedValue === 'yes'){-->
<!--            if(change == 'true'){-->
<!--                window.location.href='insert-address?change=true';-->
<!--            }-->

<!--        } else {-->
<!--            window.location.href='summary'-->
<!--        }-->


<!--    });-->
<!--</script>-->


<!--show results table when search button is clicked-->
<script>
    const btnSearch = document.querySelector('#btn-search');

    btnSearch.addEventListener('click', (event) => {
        event.preventDefault();
        const tblResults = document.querySelector('#table-results');
        tblResults.removeAttribute('hidden');

    })


    //    Hide results table when reset filter button is clicked

    const btnReset = document.querySelector('#btn-reset');

    btnReset.addEventListener('click', (event) => {
        event.preventDefault();
        const searchForm = document.querySelector('#search-form');
        searchForm.reset();

        //hide the result table
        const tblResults = document.querySelector('#table-results');
        tblResults.setAttribute('hidden', 'true');
    });


    //update the main form with the selected OU code and collapse the details
    const selectElements = document.querySelectorAll('[data-contact]');
    console.log(selectElements);

    selectElements.forEach(selectElem => {
        selectElem.addEventListener("click", (event) => {
            event.preventDefault();

            const addressDetails = event.currentTarget.dataset.contact.split(',');



            const address1 = addressDetails[0];
            const address2 = addressDetails[1];
            const address3 = addressDetails[2];
            const address4 = addressDetails[3];
            const postcode = addressDetails[4];


            window.location.href=`insert-address?address1=${address1}&address2=${address2}&address3=${address3}&address4=${address4}&postcode=${postcode}`;

        }) ;
    })
</script>


{% endblock %}
